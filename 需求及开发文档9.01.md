1. 项目/功能概述 (Overview)
开发一个 AI 驱动的、支持云端同步的 Web 个人生产力中心。最终目标是打造一个以 Notion 风格为核心设计语言的、简洁高效的应用。用户可以通过笔记、任务管理、AI 对话等功能，全面提升信息处理和日常工作的效率。

2. 核心功能点 (Core Features)
用户认证系统:

用户可以注册新账号和登录。

系统将安全地存储用户的个人信息和 API Key。

笔记管理 (CRUD):

创建、读取、更新、删除笔记。

AI 助手功能:

内容生成与优化、总结与提炼、智能问答、自动化整理。

个性化设置:

独立的“设置”页面，用于管理用户的 OpenRouter API Key。

3. 技术规格 (Technical Specifications)
前端 (Frontend)
设计风格 (Design Style): 严格遵循 Notion 风格。这意味着：

布局: 干净、结构化的多栏布局。

色彩: 以黑、白、灰为主色调，辅以少量强调色用于状态和提醒。

字体: 使用清晰、易读的无衬线字体（如 Inter）。

图标: 采用简约、线性的单色图标系统（如 Lucide Icons）。

交互: 交互反馈应简洁、快速，无过多花哨动画。

页面/组件 (Pages/Components):

LoginPage / RegisterPage: 用于用户登录和注册的独立页面。

MainAppPage (主应用页): 这是核心界面，采用三栏布局：

Sidebar (侧边栏 - 第1栏): 显示文件夹、标签或特殊视图（如“收藏”）。

NoteList (笔记列表 - 第2栏): 展示当前选定文件夹/标签下的所有笔记标题和摘要。

Editor (编辑器 - 第3栏): 主要的笔记编写区域，支持 Markdown 或富文本。

AIAssistantPanel (AI 助手面板): 一个浮动或侧边弹出的窗口，用于显示 AI 功能的操作按钮和返回结果。

SettingsPage: 用于管理用户账户和 API Key。

后端 (Backend)
API 接口 (API Endpoints):

用户认证 (Auth):

POST /api/auth/register: 注册新用户。请求体需包含 email 和 password。

POST /api/auth/login: 用户登录。请求体需包含 email 和 password，成功后返回一个 access_token (JWT)。

笔记管理 (Notes):

GET /api/notes: 获取当前已登录用户的所有笔记列表。

POST /api/notes: 创建一篇新笔记。请求体包含 title 和 content。

GET /api/notes/{note_id}: 获取单篇笔记的详细内容。

PUT /api/notes/{note_id}: 更新一篇指定的笔记。

DELETE /api/notes/{note_id}: 删除一篇指定的笔记。

AI 功能 (AI Proxy):

POST /api/ai/process: 代理 AI 请求。请求体包含 note_content (笔记上下文), selected_text (选中的文本), action (指令, 如 "summarize", "polish")。后端使用用户存储的 API Key 调用 OpenRouter 服务，并将结果返回。此设计旨在保护用户的 API Key 不在前端泄露。

设置 (Settings):

PUT /api/settings/api-key: 更新用户的 OpenRouter API Key。请求体包含 api_key。

数据模型 (Data Models):

User (用户表):

id (主键, UUID)

email (字符串, 唯一索引)

password_hash (字符串, 绝不存储明文密码，必须哈希处理)

openrouter_api_key_encrypted (字符串, 数据库中必须加密存储，不能是明文)

created_at (时间戳)

Note (笔记表):

id (主键, UUID)

user_id (外键, 关联到 User 表的 id)

title (字符串)

content (长文本)

tags (JSON 或文本数组)

created_at (时间戳)

updated_at (时间戳)

安全与最佳实践 (Security & Best Practices):

认证机制: 所有需要登录才能访问的 API (如笔记管理) 必须通过 JWT (JSON Web Token)进行保护。

权限控制: 后端逻辑必须严格校验，确保用户只能访问和修改自己的数据（例如，更新笔记时，要检查笔记的 user_id 是否与 token 中的 user_id 匹配）。

数据校验: 所有传入后端的数据都必须经过严格的格式和类型校验（FastAPI 内置的 Pydantic 模型可完美实现此功能）。

密钥管理: 数据库密码、JWT 密钥等敏感信息必须通过环境变量进行管理，严禁硬编码在代码中。

4. 技术栈建议 (Tech Stack Suggestion)
前端 (Frontend):

框架: React (使用 Vite 初始化项目，它提供了极快的开发服务器和优化的构建流程)。

样式: Tailwind CSS (功能类优先的 CSS 框架，能最高效地实现 Notion 的像素级精确设计)。

图标库: Lucide React (一套风格简洁、统一的图标库，与 Notion 风格完美契合)。

API 通信: Axios (一个强大的 HTTP 客户端，用于与后端 API 进行通信)。

状态管理: Zustand (一个轻量、简洁的全局状态管理库，对初学者非常友好)。

后端 (Backend):

框架: Python + FastAPI (现代、高性能的 Python Web 框架，自带交互式 API 文档，其基于 Pydantic 的数据验证能极大提升代码健壮性)。

密码安全: Passlib (用于安全地哈希和验证用户密码)。

认证令牌: python-jose (用于创建和验证 JWT)。

数据库与服务 (Database & Services):

一体化后端服务: Supabase (提供免费的 PostgreSQL 数据库、开箱即用的用户认证系统和文件存储服务，是独立开发者的绝佳选择)。

部署 (Deployment):

前端部署: Vercel (与 React 项目无缝集成，提供全球 CDN 和自动 CI/CD，部署体验极佳)。

后端部署: Render (提供免费的 Web Service 和 PostgreSQL 数据库托管服务，非常适合部署 FastAPI 应用)。

5. 开发步骤建议 (Development Steps)
我们将项目分解为一系列清晰、可执行的小任务，以确保您能循序渐进地完成：

【后端】环境与用户系统:

1.1. 在 Supabase 上创建新项目，获取数据库连接信息和 API Keys。

1.2. 初始化 FastAPI 项目，配置数据库连接。

1.3. 定义 User 和 Note 的数据模型。

1.4. 实现 POST /api/auth/register 用户注册接口（包含密码哈希）。

1.5. 实现 POST /api/auth/login 用户登录接口（包含 JWT 生成）。

【前端】基础框架搭建:

2.1. 使用 Vite 创建一个新的 React 项目。

2.2. 集成并配置 Tailwind CSS。

2.3. 创建 LoginPage, RegisterPage 和 MainAppPage 的基本页面骨架。

2.4. 在 MainAppPage 中搭建三栏布局的组件 (Sidebar, NoteList, Editor)。

【前后端】登录与笔记展示:

3.1. 【前】实现登录/注册页面的表单逻辑，调用后端 API。

3.2. 【前】实现登录成功后，将 JWT 保存并在后续请求中携带。

3.3. 【后】实现笔记相关的 CRUD API (/api/notes)，并确保它们受 JWT 保护。

3.4. 【前】在 MainAppPage 加载时，调用 GET /api/notes 获取笔记列表并展示。

【前端】编辑器功能完善:

4.1. 集成一个 Markdown 编辑器库 (如 react-markdown 或 tiptap)。

4.2. 实现笔记的创建、编辑和实时保存功能。

4.3. 实现笔记的删除功能，并给出确认提示。

【前后端】核心 AI 功能:

5.1. 【后】实现 POST /api/ai/process 代理接口的逻辑。

5.2. 【前】设计并实现 AIAssistantPanel 组件。

5.3. 【前】当用户在编辑器中选中文本并点击 AI 功能按钮时，调用 AI 代理接口并展示返回结果。

【前后端】设置页面:

6.1. 【前】创建 SettingsPage，包含一个用于输入 API Key 的表单。

6.2. 【后】实现 PUT /api/settings/api-key 接口，对 API Key 加密后存入数据库。

6.3. 【前】将设置页面与后端接口打通。

【收尾】润色与部署:

7.1. 添加全局的加载状态和错误提示。

7.2. 检查并优化应用的响应式设计。

7.3. 将前端项目部署到 Vercel，后端项目部署到 Render。

6. V2.0 进阶功能规划 (Advanced Features Roadmap)
在完成 V1.0 核心功能后，我们将按以下模块逐步扩展应用，打造终极生产力中心。

模块一：AI 工作流增强
功能 1.1：模板化 AI 指令 (AI Templates)

目标: 允许用户预设常用的 AI 指令，实现一键执行。

实现: 后端需新增 AITemplate 数据表和相关 API；前端在设置页增加模板管理功能。

功能 1.2：关联笔记推荐 (Related Notes Suggestion)

目标: AI 自动分析当前笔记，推荐相关笔记，构建知识网络。

实现: 需引入向量数据库 (如 pgvector)，在笔记保存时生成文本嵌入 (Embeddings) 并进行相似度搜索。

功能 1.3：多模态支持 (Multi-modal Input)

目标: 允许用户上传图片或音频，并让 AI 进行理解和问答。

实现: 需集成对象存储 (如 Supabase Storage)，并调用支持多模态的 AI 模型。

模块二：用户体验与效率提升
功能 2.1：全局命令面板 (Command Palette)

目标: 实现 Cmd/Ctrl + K 快速搜索和执行命令。

实现: 前端实现一个全局模态框组件；后端提供一个优化的搜索 API。

功能 2.2：双向链接 (Bi-directional Linking)

目标: 支持 [[笔记标题]] 语法，并自动显示反向链接。

实现: 后端新增 NoteLink 数据表记录链接关系；前端升级编辑器以支持该语法。

功能 2.3：版本历史 (Version History)

目标: 自动保存笔记的修改历史，可随时恢复。

实现: 后端新增 NoteHistory 数据表，在每次更新笔记时创建快照。

模块三：生产力工具集成
功能 3.1：任务清单 (To-do List)

目标: 集成一个简单高效的待办事项管理功能。

实现: 后端新增 Todo 数据表和相关 API；前端开发独立的任务管理组件。

功能 3.2：多模型 AI 对话 (Multi-Model AI Chat)

目标: 提供一个独立的 AI 对话界面，可切换不同的大模型。

实现: 后端新增 ChatSession 和 ChatMessage 数据表及 /api/chat 流式 API；前端实现对话界面。

功能 3.3：番茄钟与主题定制 (Pomodoro Timer & Themes)

目标: 内置番茄工作钟，并允许用户自定义应用的主题配色。

实现: 番茄钟逻辑主要在前端实现；主题配色方案可保存在用户偏好设置中，后端需提供接口保存这些设置。